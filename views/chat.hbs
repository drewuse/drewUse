<!-- <style>
#messages {
    height: 400px;
    background-color: #fff;
    overflow: auto;
    padding: 2px;
}
</style>
<script src="/socket.io/socket.io.js"></script>
<br>
  <h1>Messages</h1>
  <div class="row">
    <div class="col-sm-4">
      <div class="card mb-3" style="max-height: 5rem;">
        <div class="row no-gutters">
          <div class="col-md-4" >
            <img class="card-img-top" src="" alt="Card image cap" style="max-height: 5rem;">
          </div>
          <div class="col-md-8">
          <div class="card-body">
            <h5 class="card-title">Card title</h5>
          </div>
        </div>
      </div>
      </div>
      <div class="card mb-3" style="max-height: 5rem;">
        <div class="row no-gutters">
          <div class="col-md-4" >
            <img class="card-img-top" src="" alt="Card image cap" style="max-height: 5rem;">
          </div>
          <div class="col-md-8">
          <div class="card-body">
            <h5 class="card-title">Card title</h5>
          </div>
        </div>
      </div>
      </div>
      <div class="card mb-3" style="max-height: 5rem;">
        <div class="row no-gutters">
          <div class="col-md-4" >
            <img class="card-img-top" src="" alt="Card image cap" style="max-height: 5rem;">
          </div>
          <div class="col-md-8">
          <div class="card-body">
            <h5 class="card-title">Card title</h5>
          </div>
        </div>
      </div>
      </div>
    </div>
    <div class="col-sm-8">

      <div class="jumbotron">
        <div id="messages">

        </div>
            <br>
            <input id = "name" class="form-control" placeholder="Name">
            <br>
            <textarea id = "message" class="form-control" placeholder="Your Message Here"></textarea>
            <br>
            <button id="send" class="btn btn-success">Send</button>
        </div>

    </div>
  </div>

<script>
   var socket = io();
    $(() => {
        $("#send").click(()=>{
            sendMessage({name: $("#name").val(), message: $("#message").val()});
        })
        getMessages()
    })
    socket.on('message', addMessages)
    function addMessages(message){
        $("#messages").append(`<h4> ${message.name} </h4> <p> ${message.message} </p>`)
    }
    function getMessages(){
      $.get('http://localhost:8000/messages', (data) => {
        data.forEach(addMessages);
      })
    }
    function sendMessage(message){
      $.post('http://localhost:8000/messages', message)
    }
   var socket =io('//localhost:8000');
   socket.on('socketToMe', function(data){
     console.log(data);
   })
</script> -->
<style>

@mixin vertical-align {
  position: relative;
  top: 50%;
  -webkit-transform: translateY(-50%);
  -ms-transform: translateY(-50%);
  transform: translateY(-50%);
}

* {
    box-sizing: border-box;
}

html {
    height: 100%;
}

body {
    margin: 0px;
    height: 100%;
}

header {
    text-align: center;
}

h1 {
    font-family: 'Comfortaa', sans-serif;
    margin: 0px;
}

div#change_username, section#input_zone {
    border: 5px outset #8258FA;
}

div#change_username {
    height: 3%;
    display: inline-block;
    background-color: #BCA9F5;
}

section#chatroom {
    border: 5px inset #8258FA;
    height: 85%;
    overflow: auto;
}

section#input_zone {
    height: 7%;
    text-align: center;
    background-color: #BCA9F5;
}

.vertical-align {
    position: relative;
    top: 50%;
    -webkit-transform: translateY(-50%);
    -ms-transform: translateY(-50%);
    transform: translateY(-50%);
}

input#username {
    font-family: 'Comfortaa', sans-serif;
}

input#message {
    display: inline-block;
    width: 88%;
    height: 70%;
    font-family: 'Comfortaa', sans-serif;
    font-size: 2vh;
}

button#send_message {
    display: inline-block;
    height: 70%;
    width: 10%;
}

p.message {
    margin: 0px;
    width: 100%;
    height: 40px;
    font-size: 2vh;
    font-family: 'Comfortaa', sans-serif;
    padding: 1vh;
}

.message:nth-child(even) {
    background-color: #81DAF5;
}

.message:nth-child(odd) {
    background-color: #81BEF7;
}
</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.0.4/socket.io.js"></script>
<br>
  <div class="row">
    <div class="col-sm-4">
      <header>
          <h1>Messages</h1>
      </header>
      <div class="card mb-3" style="max-height: 5rem;">
        <div class="row no-gutters">
          <div class="col-md-4" >
            <img class="card-img-top" src="" alt="Card image cap" style="max-height: 5rem;">
          </div>
          <div class="col-md-8">
          <div class="card-body">
            <h5 class="card-title">Card title</h5>
          </div>
        </div>
      </div>
      </div>
    </div>
    <div class="col-sm-8">
        <!-- <section>
          <div id="change_username">
    	<input id="username" type="text" />
    	<button id="send_username" type="button">Change username</button>
          </div>
        </section> -->

        <section id="chatroom">
          <section id="feedback"></section>
        </section>

        <section id="input_zone">
          <input id="message" class="vertical-align" type="text" />
          <button id="send_message" class="vertical-align" type="button">Send</button>
        </section>
  </div>
</div>

    <script src="http://code.jquery.com/jquery-latest.min.js"></script>
    <script>
    $(function(){
       	//make connection
    	var socket = io.connect('http://localhost:8000')

    	//buttons and inputs
    	var message = $("#message")
    	var username = $("#username")
    	var send_message = $("#send_message")
    	var send_username = $("#send_username")
    	var chatroom = $("#chatroom")
    	var feedback = $("#feedback")

    	//Emit message
    	send_message.click(function(){
    		socket.emit('new_message', {message : message.val()})
    	})

    	//Listen on new_message
    	socket.on("new_message", (data) => {
    		feedback.html('');
    		message.val('');
    		chatroom.append("<p class='message'>" + data.username + ": " + data.message + "</p>")
    	})

    	//Emit a username
    	send_username.click(function(){
    		socket.emit('change_username', {username : username.val()})
    	})

    	//Emit typing
    	message.bind("keypress", () => {
    		socket.emit('typing')
    	})

    	//Listen on typing
    	socket.on('typing', (data) => {
    		feedback.html("<p><i>" + data.username + " is typing a message..." + "</i></p>")
    	})
    });
    </script>
